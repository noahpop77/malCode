IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwoKaW1wb3J0IG9zLCBzeXMsIHBhcmFtaWtvCmltcG9ydCBz
aWduYWwKaW1wb3J0IGVycm5vCmltcG9ydCBhdGV4aXQKaW1wb3J0IHNvY2tldAojZnJvbSBzb2Nr
ZXQgaW1wb3J0ICoKZnJvbSBsb2d6ZXJvIGltcG9ydCBsb2dnZXIKaW1wb3J0IHRpbWUKaW1wb3J0
IHN1YnByb2Nlc3MKaW1wb3J0IHRraW50ZXIKaW1wb3J0IGJhc2U2NAppbXBvcnQgcmVxdWVzdHMK
CiMgRnVuY3Rpb24gdG8gZGFlbW9uaXplIGNvZGUKZGVmIGRhZW1vbml6ZShzZWxmKToKICAgIHRy
eToKICAgICAgICAgICAgcGlkID0gb3MuZm9yaygpCiAgICAgICAgICAgIGlmIHBpZCA+IDA6CiAg
ICAgICAgICAgICAgICAgICAgIyBleGl0IGZpcnN0IHBhcmVudAogICAgICAgICAgICAgICAgICAg
IHN5cy5leGl0KDApCiAgICBleGNlcHQgT1NFcnJvciBhcyBlOgogICAgICAgICAgICBzeXMuc3Rk
ZXJyLndyaXRlKCJmb3JrICMxIGZhaWxlZDogJWQgKCVzKVxuIiAlIChlLmVycm5vLCBlLnN0cmVy
cm9yKSkKICAgICAgICAgICAgc3lzLmV4aXQoMSkKCiAgICAjIGRlY291cGxlIGZyb20gcGFyZW50
IGVudmlyb25tZW50CiAgICBvcy5jaGRpcigiL3RtcC8iKQogICAgb3Muc2V0c2lkKCkKICAgIG9z
LnVtYXNrKDApCgogICAgIyBkbyBzZWNvbmQgZm9yawogICAgdHJ5OgogICAgICAgICAgICBwaWQg
PSBvcy5mb3JrKCkKICAgICAgICAgICAgaWYgcGlkID4gMDoKICAgICAgICAgICAgICAgICAgICAj
IGV4aXQgZnJvbSBzZWNvbmQgcGFyZW50CiAgICAgICAgICAgICAgICAgICAgc3lzLmV4aXQoMCkK
ICAgIGV4Y2VwdCBPU0Vycm9yIGFzIGU6CiAgICAgICAgICAgIHN5cy5zdGRlcnIud3JpdGUoImZv
cmsgIzIgZmFpbGVkOiAlZCAoJXMpXG4iICUgKGUuZXJybm8sIGUuc3RyZXJyb3IpKQogICAgICAg
ICAgICBzeXMuZXhpdCgxKQoKICAgICMgcmVkaXJlY3Qgc3RhbmRhcmQgZmlsZSBkZXNjcmlwdG9y
cwogICAgc3lzLnN0ZG91dC5mbHVzaCgpCiAgICBzeXMuc3RkZXJyLmZsdXNoKCkKCiAgICBzaSA9
IGZpbGUoc2VsZi5zdGRpbiwgJ3InKQogICAgc28gPSBmaWxlKHNlbGYuc3Rkb3V0LCAnYSsnKQog
ICAgc2UgPSBmaWxlKHNlbGYuc3RkZXJyLCAnYSsnLCAwKQoKICAgIG9zLmR1cDIoc2kuZmlsZW5v
KCksIHN5cy5zdGRpbi5maWxlbm8oKSkKICAgIG9zLmR1cDIoc28uZmlsZW5vKCksIHN5cy5zdGRv
dXQuZmlsZW5vKCkpCiAgICBvcy5kdXAyKHNlLmZpbGVubygpLCBzeXMuc3RkZXJyLmZpbGVubygp
KQoKICAgICMgd3JpdGUgcGlkZmlsZQogICAgYXRleGl0LnJlZ2lzdGVyKHNlbGYuZGVscGlkKQog
ICAgZmlsZShzZWxmLnBpZGZpbGUsJ3crJykud3JpdGUoIiVzXG4iICUgcGlkKQoKZGVmIHJldlRD
UCgpOgogICAgICAgICMgTWFpbiBsb29wIGZvciByZXZlcnNlIFRDUCBjb25uZWN0aW9uCiAgICAg
ICAgd2hpbGUgVHJ1ZToKICAgICAgICAjIEFjY2VwdHMgdGhlIGluY29taW5nIGNvbm5lY3Rpb24g
b25jZSBvbmUgaXMgZW5kZWQKICAgICAgICAjIFNvY2tldCBnZXRzIGRlY2xhcmVkCiAgICAgICAg
IyBDcmVhdGVzIHNvY2tldCBjb25uZWN0aW9uCiAgICAgICAgICAgICAgICBteVNvY2tldCA9IHNv
Y2tldC5zb2NrZXQoc29ja2V0LkFGX0lORVQsIHNvY2tldC5TT0NLX1NUUkVBTSkKICAgICAgICAg
ICAgICAgIG15U29ja2V0LnNldHNvY2tvcHQoc29ja2V0LlNPTF9TT0NLRVQsc29ja2V0LlNPX1JF
VVNFQUREUiwxKQoKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAg
bXlTb2NrZXQuY29ubmVjdCgoJzEyNy4wLjAuMScsMTIzNCkpCiAgICAgICAgICAgICAgICBleGNl
cHQ6CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgI2NvbW1hbmRPdXQuYXBw
ZW5kKHN1YnByb2Nlc3MuY2hlY2tfb3V0cHV0KFsnbHMnLCAnLWwnXSkpCiAgICAgICAgI2NvbW1h
bmRPdXQuYXBwZW5kKHN1YnByb2Nlc3MuY2hlY2tfb3V0cHV0KFsnd2hvYW1pJ10pKQogICAgICAg
ICNjb21tYW5kT3V0LmFwcGVuZChzdWJwcm9jZXNzLmNoZWNrX291dHB1dChbJ2lmY29uZmlnJ10p
KQogICAgICAgICMjY29tbWFuZE91dCA9IFtdCiAgICAgICAgIyMjIENvbW1hbmQgaSB3YW50IHRv
IGV4ZWN1dGUgd2lsbCBydW4gYW5kIHJldHVybi9zZW5kIHRoZSBvdXRwdXQgb2YgdGhhdCBjb21t
YW5kIHRvIG15IGNhdGNoIHNlcnZlci4KICAgICAgICAjI2NvbW1hbmRPdXQuYXBwZW5kKHN1YnBy
b2Nlc3MuY2hlY2tfb3V0cHV0KFsnd2hvYW1pJ10pKQogICAgICAgICMjbXlTb2NrZXQuc2VuZChm
Intjb21tYW5kT3V0fSIuZW5jb2RlKCd1dGYtOCcpKQogICAgICAgICAgICAgICAgdHJ5OgogICAg
ICAgICAgICAgICAgICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGNvbW1hbmQgPSBteVNvY2tldC5yZWN2KDEwMjQpLmRlY29kZSgndXRmLTgnKQogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGNvbW1hbmQgPT0gJ3EnOgogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXlTb2NrZXQuY2xvc2UoKQogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3lzLmV4aXQoMCkKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgcHJvYyA9IHN1YnByb2Nlc3MuUG9wZW4oY29tbWFuZCwgc2hlbGw9VHJ1ZSwgc3Rkb3V0
PXN1YnByb2Nlc3MuUElQRSwgc3RkZXJyPXN1YnByb2Nlc3MuUElQRSwgc3RkaW49c3VicHJvY2Vz
cy5QSVBFKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0ID0g
cHJvYy5zdGRvdXQucmVhZCgpICsgcHJvYy5zdGRlcnIucmVhZCgpCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBteVNvY2tldC5zZW5kKHN0cihvdXRwdXQpLmVuY29kZSgn
dXRmLTgnKSkKICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICAgICAg
bXlTb2NrZXQuY2xvc2UoKQogICAgICAgICAgICAgICAgICAgICAgICBzeXMuZXhpdCgwKQogICAg
ICAgICAgICAgICAgbXlTb2NrZXQuY2xvc2UoKQoKZGFlbW9uaXplCndoaWxlIFRydWU6CiAgICAg
ICAgdGltZS5zbGVlcCgzKQogICAgICAgIHVybCA9ICJodHRwczovL3Jhdy5naXRodWJ1c2VyY29u
dGVudC5jb20vbm9haHBvcDc3L21hbENvZGUvbWFzdGVyL2Nvbi50eHQiCiAgICAgICAgcmVxID0g
cmVxdWVzdHMuZ2V0KHVybCkKICAgICAgICAjcHJpbnQocmVxLnRleHQpCiAgICAgICAgaWYgcmVx
LnRleHQgPT0gIjFcbiI6CiAgICAgICAgICAgICAgICByZXZUQ1AoKQogICAgICAgIGVsc2U6CiAg
ICAgICAgICAgICAgICBwYXNzCnN5cy5leGl0KDAp
